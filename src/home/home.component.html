<div class="w-full overflow-x-hidden">
  <header 
    #header
    class="text-white fixed w-full transition-all duration-500" 
    style="z-index: 50;">
    <div 
      #headerBg
      class="absolute inset-0 bg-black transition-opacity duration-500"
      style="opacity: 0;"
    ></div>
    <div class="h-20 relative z-10">
      <!-- Left: Logo -->
      <div
        #headerLogo
        class="absolute left-2 sm:left-4 lg:left-8 top-1/2 transform -translate-y-1/2 flex items-center transition-opacity duration-500"
        style="opacity: 0;"
      >
        <div class="flex items-center gap-2 sm:gap-3">
          <img src="assets/svgs/SPGA.svg" alt="SPGA" class="h-8 sm:h-10 w-auto" />
          <span class="text-sm min-[900px]:text-base xl:text-xl font-light font-canela-deck">
            Arquitectura
            <span style="font-style: italic; font-weight: 100">&amp;</span>
            Interiorismo
          </span>
        </div>
      </div>

      <!-- Center: constrained nav, centered in page -->
      <div
        class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-center"
      >
        <nav class="hidden min-[900px]:flex min-[900px]:space-x-6 xl:space-x-20 mt-2">
          <a
            href="#servicios"
            (click)="scrollToSection('servicios', $event)"
            class="min-[900px]:text-sm xl:text-lg text-white border-b-2 border-transparent pb-2 hover:border-white"
            >Servicios</a
          >
          <a
            href="#proyectos"
            (click)="scrollToSection('proyectos', $event)"
            class="min-[900px]:text-sm xl:text-lg text-white border-b-2 border-transparent pb-2 hover:border-white"
            >Proyectos</a
          >
          <a
            href="#sobre-nosotros"
            (click)="scrollToSection('sobre-nosotros', $event)"
            class="min-[900px]:text-sm xl:text-lg text-white border-b-2 border-transparent pb-2 hover:border-white"
            >Sobre Nosotros</a
          >
        </nav>
      </div>

      <!-- Right: buttons flush to the viewport right -->
      <div
        class="absolute right-2 sm:right-4 lg:right-8 top-1/2 transform -translate-y-1/2 flex items-center"
      >
        <div class="flex items-center gap-2 sm:gap-4">
          <!-- Hamburger Button (Mobile) -->
          <button
            (click)="toggleMobileMenu()"
            class="min-[900px]:hidden bg-white text-black focus:outline-none w-8 h-8 rounded-full flex items-center justify-center mr-4"
            aria-label="Menu"
          >
          </button>

          <button
            (click)="scrollToSection('contacto', $event)"
            class="hidden min-[900px]:inline-flex items-center min-[900px]:px-3 min-[900px]:py-1.5 xl:px-4 xl:py-2 border border-white text-white rounded hover:border-transparent transition min-[900px]:text-xs xl:text-base"
          >
            Contáctanos
            <img
              src="assets/svgs/whatsapp.svg"
              alt="WhatsApp"
              class="h-4 sm:h-5 w-4 sm:w-5 ml-2 sm:ml-3"
            />
          </button>

          <button
            routerLink="/budget"
            class="hidden min-[900px]:inline-flex items-center min-[900px]:px-3 min-[900px]:py-1.5 xl:px-4 xl:py-2 bg-white text-black rounded hover:opacity-90 transition min-[900px]:text-xs xl:text-base"
          >
            Presupuesta
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 sm:h-5 w-4 sm:w-5 ml-2 sm:ml-3"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 12h14M12 5l7 7-7 7"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Menu Overlay -->
  <div
    *ngIf="mobileMenuOpen()"
    class="fixed inset-0 z-[100] bg-[#0a0a0a] text-white flex flex-col"
  >
    <!-- Header -->
    <div class="h-20 px-4 flex items-center justify-between border-b border-white/20">
      <div class="flex items-center gap-3">
        <img src="assets/svgs/SPGA.svg" alt="SPGA" class="h-8 w-auto" />
        <span class="text-sm font-light font-canela-deck">
          Arquitectura
          <span style="font-style: italic; font-weight: 100">&amp;</span>
          Interiorismo
        </span>
      </div>
      <button (click)="toggleMobileMenu()" class="p-2 flex items-center justify-center">
        <!-- Diamond close icon -->
        <div class="w-6 h-6 bg-white transform rotate-45"></div>
      </button>
    </div>

    <!-- Menu Items -->
    <div class="flex-1 flex flex-col justify-end">
      <a
        href="#servicios"
        (click)="toggleMobileMenu(); scrollToSection('servicios', $event)"
        class="w-full h-24 flex items-center justify-center px-8 text-xl font-light border-t border-white/20 hover:bg-white/5 transition"
      >
        Servicios
      </a>
      <a
        href="#proyectos"
        (click)="toggleMobileMenu(); scrollToSection('proyectos', $event)"
        class="w-full h-24 flex items-center justify-center px-8 text-xl font-light border-t border-white/20 hover:bg-white/5 transition"
      >
        Proyectos
      </a>
      <a
        href="#sobre-nosotros"
        (click)="toggleMobileMenu(); scrollToSection('sobre-nosotros', $event)"
        class="w-full h-24 flex items-center justify-center px-8 text-xl font-light border-t border-white/20 hover:bg-white/5 transition"
      >
        Sobre nosotros
      </a>
      
      <!-- Contact Button -->
      <button
        (click)="toggleMobileMenu(); scrollToSection('contacto', $event)"
        class="w-full h-24 bg-white text-black flex items-center justify-center px-8 gap-3 text-lg font-medium uppercase tracking-wide border-t border-white/20"
      >
        CONTÁCTANOS
        <img src="assets/svgs/whatsapp_black.svg" alt="WhatsApp" class="h-6 w-6" />
      </button>
      
      <!-- Budget Button -->
      <button
        routerLink="/budget"
        (click)="toggleMobileMenu()"
        class="w-full h-24 bg-black text-white border-t border-white/20 flex items-center justify-center px-8 gap-3 text-lg font-medium uppercase tracking-wide"
      >
        PRESUPUESTA
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 12h14M12 5l7 7-7 7"
          />
        </svg>
      </button>
    </div>
  </div>

  <!-- Hero image below the header -->
  <main class="w-full h-screen bg-gray-50">
    <section class="w-full h-full">
      <div class="w-full h-full overflow-hidden">
        <img
          src="assets/pictures/first-image.png"
          alt="Hero image"
          class="w-full h-full object-cover"
        />
        
        <!-- Hero Logo - Top Left (will transition to header) -->
        <div 
          #heroLogo
          class="absolute top-12 left-12 z-10 text-white transition-all duration-700 ease-out"
          style="transform-origin: top left;"
        >
          <div class="flex flex-col items-start gap-4">
            <img src="assets/svgs/SPGA.svg" alt="SPGA" class="h-56 sm:h-72 md:h-80 w-auto drop-shadow-2xl" />
            <span 
              #heroText
              class="text-2xl sm:text-3xl font-canela-deck font-light tracking-wide drop-shadow-lg transition-opacity duration-300"
            >
              Arquitectura
              <span style="font-style: italic; font-weight: 100" class="mx-2">&amp;</span>
              Interiorismo
            </span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Intro text below hero -->
  <section class="w-full pl-4 pr-4 sm:pl-6 sm:pr-6 lg:pl-8 lg:pr-8 pt-12 pb-0">
    <div class="w-full">
      <h2
        class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl leading-tight font-canela-deck font-thin thin-visual text-left"
      >
        Somos un estudio de arquitectura
        <br />
        caracterizado por una línea de diseño
        <br />
        clara y funcional.
      </h2>
    </div>
  </section>

  <!-- Owl-like Carousel Component -->
  <section class="w-full h-screen pt-12">
    <owl-carousel
      class="w-full h-full block"
      [slides]="slides"
      [options]="carouselOptions"
    >
    </owl-carousel>
  </section>

  <!-- New pale background section -->
  <section
    id="servicios"
    class="w-full flex flex-col items-center justify-center scroll-mt-28"
    style="background: #e0ddcb; height: 100vh"
  >
    <h2
      class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl leading-tight font-canela-deck font-thin thin-visual text-center mb-10"
    >
      Servicios integrales
    </h2>
    <!-- Services integrales autoplay carousel (full width, 50vh height) -->
    <div
      class="w-full"
      style="height: 50vh"
    >
      <simple-auto-carousel
        class="w-full h-full block"
        [slides]="servicesSlides"
        [options]="servicesCarouselOptions"
      ></simple-auto-carousel>
    </div>
  </section>
  <!-- Proyectos section (same heading style, plain background, full viewport height) -->
  <section
    id="proyectos"
    class="w-full flex items-center justify-center scroll-mt-28 min-h-screen py-12 md:py-0"
  >
    <div class="w-full max-w-7xl px-4 sm:px-6 lg:px-8 text-center">
      <h2
        class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl leading-tight font-canela-deck font-thin thin-visual text-center"
      >
        Proyectos
      </h2>
      <!-- Three project cards row -->
      <div class="mt-12 flex flex-col md:flex-row justify-center items-center gap-8">
        <ng-container *ngFor="let p of projects; let i = index">
          <div
            class="group relative flex flex-col items-center justify-between rounded-sm transition-all duration-300 bg-white overflow-hidden fade-in-section w-full max-w-md md:w-[420px] h-auto"
            #fadeInElement
            [ngClass]="{
              'md:h-[640px]': i === 1,
              'md:h-[500px]': i !== 1
            }"
          >
            <!-- Year and Type labels (above image) -->
            <div class="w-full flex justify-between items-center  pt-4 pb-2">
              <span class="text-sm font-light text-black">{{ p.year }}</span>
              <span class="text-sm font-light text-black">{{ p.type }}</span>
            </div>
            
            <div
            class="relative group cursor-pointer w-full h-[350px]"
            [ngClass]="{
              'md:h-[520px]': i === 1,
              'md:h-[380px]': i !== 1
            }"
            (mouseenter)="i === 1 ? (revealImageProgress = 1) : null"
            (mouseleave)="i === 1 ? (revealImageProgress = 0) : null"
          >
              <img
                [src]="p.image"
                [alt]="p.title"
                class="absolute inset-0 w-full h-full object-cover"
                draggable="false"
              />
              <div
                class="absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent pointer-events-none"
              ></div>
            </div>
            <div class="w-full px-6 pt-6 flex flex-col">
              <h3
                class="text-2xl font-canela-deck font-light mb-2 tracking-wide"
              >
                {{ p.title }}
              </h3>
              <p class="text-base font-light text-gray-700 mb-4">
                {{ p.subtitle }}
              </p>
              <div class="flex items-center gap-4 mt-auto pb-6">
                <button
                  (click)="openCarousel(p)"
                  class="flex-1 bg-black text-white py-3 text-sm uppercase tracking-wide hover:opacity-85 transition"
                >
                  Ver proyecto
                </button>
                <button
                  *ngIf="p.hasModel"
                  (click)="openModel(i)"
                  class="flex-1 border border-black py-3 text-sm uppercase tracking-wide hover:bg-black hover:text-white transition"
                  [disabled]="i !== 0"
                >
                  Ver modelo 3D
                </button>
              </div>
            </div>
            <!-- subtle emphasis on center card -->
            <div
              *ngIf="i === 1"
              class="absolute inset-0 -z-10 rounded-sm"
            ></div>
          </div>
        </ng-container>
      </div>
    </div>
  </section>

  <project-carousel
    *ngIf="isCarouselOpen && selectedProject"
    [images]="selectedProject.images"
    [title]="selectedProject.title"
    [year]="selectedProject.year"
    [type]="selectedProject.type"
    [services]="selectedProject.services"
    (close)="closeCarousel()"
  ></project-carousel>
</div>
<!-- Fullscreen 3D model overlay -->
<div
  *ngIf="showModel"
  class="fixed inset-0 z-50"
  (document:keydown)="onKey($event)"
>
  <div
    class="absolute inset-0 bg-black/80 backdrop-blur-sm"
    (click)="closeModel()"
  ></div>
  <div class="absolute inset-0">
    <div class="relative w-full h-full">
      <button
        (click)="closeModel()"
        class="absolute top-4 right-12 w-12 h-12 flex items-center justify-center text-white bg-white/10 hover:bg-white/20 rounded-full transition"
        aria-label="Cerrar modelo"
        style="margin-right: 3rem"
      >
        <span class="text-2xl leading-none">×</span>
      </button>
      <!-- Loading state -->
      <div
        *ngIf="loadingModel"
        class="absolute inset-0 flex items-center justify-center bg-black/40 pointer-events-none"
      >
        <div class="flex flex-col items-center gap-4 text-white">
          <div
            class="w-14 h-14 border-4 border-white/30 border-t-white rounded-full animate-spin"
          ></div>
          <p class="text-base tracking-wide">Cargando modelo…</p>
        </div>
      </div>
      <!-- Error state -->
      <div
        *ngIf="modelError && !loadingModel"
        class="absolute inset-0 flex items-center justify-center bg-black/60"
      >
        <div class="text-center text-white px-10 max-w-md">
          <p class="mb-6 text-lg">{{ modelError }}</p>
          <button
            (click)="closeModel()"
            class="px-8 py-4 bg-white text-black rounded hover:bg-white/90 transition text-sm uppercase tracking-wide"
          >
            Cerrar
          </button>
        </div>
      </div>
      <iframe
        [src]="safeModelUrl"
        class="w-full h-full"
        loading="lazy"
        allowfullscreen
        referrerpolicy="no-referrer"
        style="border: 0"
        (load)="onModelLoad()"
        (error)="onModelError($event)"
      ></iframe>
    </div>
  </div>
</div>
<!-- Piscina image centered at 30% viewport height -->
<!-- Proyectos section (same heading style, plain background, full viewport height) -->
<!-- Full-height image section below Proyectos with scroll-driven reveal scaling -->
<section
  class="w-full flex items-end justify-center"
  style="
    background: #e0ddcb;
    height: 100vh;
    position: relative;
    overflow: hidden;
  "
>
  <reveal-image
    src="assets/pictures/piscina.png"
    alt="Featured"
    [endScale]="1"
    [scrollDistance]="600"
    [autoAfterFull]="true"
    [minScale]="0.3"
    (scaleProgress)="onRevealImageProgress($event)"
    style="position: relative; z-index: 1"
  >
  </reveal-image>

  <!-- External headline/buttons in the section (outside image) -->
  <div
    style="margin-top: 4rem"
    class="absolute inset-x-0 flex flex-col items-center justify-center pointer-events-none"
  >
    <div
      class="text-center space-y-6 w-full max-w-3xl mx-auto px-6 pointer-events-auto"
    >
      <h2
        class="text-black font-canela-deck font-thin text-4xl sm:text-5xl md:text-6xl lg:text-7xl leading-tight tracking-wide"
        style="margin-top: 2rem"
      >
        Construyamos juntos tu espacio
      </h2>
      <div
        class="flex items-center justify-center gap-6"
        style="position: relative"
      >
        <button
          (click)="scrollToSection('contacto', $event)"
          class="flex items-center justify-center flex-1 max-w-[160px] border border-black py-2.5 text-[12px] md:text-[14px] uppercase tracking-wide hover:bg-black hover:text-white transition btn-whatsapp"
          [style.z-index]="revealImageProgress >= 0.8 ? 10 : 0"
        >
          <span class="mr-2">Contáctanos</span>
          <img
            src="assets/svgs/whatsapp_black.svg"
            alt="WhatsApp"
            class="icon-default h-[18px] w-[18px]"
          />
          <img
            src="assets/svgs/whatsapp.svg"
            alt="WhatsApp"
            class="icon-hover h-[18px] w-[18px]"
          />
        </button>
        <button
          routerLink="/budget"
          class="flex items-center justify-center flex-1 max-w-[160px] bg-black text-white py-2.5 text-[12px] md:text-[14px] uppercase tracking-wide hover:opacity-85 transition"
          [style.z-index]="revealImageProgress >= 0.8 ? 10 : 0"
        >
          <span class="mr-2">Presupuesta</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-[18px] w-[18px] ml-0"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#9CA3AF"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 12h14M12 5l7 7-7 7"
            />
          </svg>
        </button>
      </div>
      <!-- Small link to services PDF -->
      <p class="mt-4 text-sm" style="margin-bottom: 1rem">
        <a
          href="assets/pdfs/servicios.pdf"
          target="_blank"
          rel="noopener noreferrer"
          class="underline hover:text-gray-700"
          aria-label="Explora nuestro PDF de servicios"
          >Explora nuestro PDF de servicios</a
        >
      </p>
    </div>
  </div>
</section>
<!-- New black 100vh section with image left and texts right -->
<section
  id="sobre-nosotros"
  class="w-full bg-black py-16 md:py-20 lg:py-24 scroll-mt-28 fade-background-section"
  #fadeInBackground
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 fade-in-section" #fadeInElement>
    <div
      class="flex flex-col lg:flex-row justify-between items-start gap-12 lg:gap-16"
    >
      <!-- Left image -->
      <div class="w-full lg:w-[45%] h-[500px] lg:h-[650px]">
        <img
          src="assets/pictures/about-us-image.png"
          alt="Equipo"
          class="w-full h-full object-cover"
        />
      </div>
      <!-- Right text block -->
      <div class="w-full lg:w-[50%] flex items-center">
        <div class="text-white space-y-8">
          <h2
            class="text-4xl md:text-5xl lg:text-6xl font-canela-deck font-light leading-tight"
          >
            Somos un equipo comprometido en la comprensión profunda de las
            necesidades de nuestros clientes.
          </h2>
          <div class="space-y-6 text-base md:text-lg leading-relaxed">
            <p>
              Nos guiamos por la responsabilidad, la innovación y la
              colaboración. Nuestro compromiso es ofrecer servicios de alta
              calidad, que superen las expectativas de nuestros clientes.
              Creemos en el poder del diseño innovador como herramienta para
              transformar espacios y mejorar la calidad de vida. Trabajamos codo
              a codo con nuestros clientes para crear soluciones únicas y
              efectivas.
            </p>
            <p>
              La sinergia de nuestro equipo nos permite abordar proyectos de
              gran envergadura, fusionando diferentes perspectivas y creando
              soluciones innovadoras. Evolucionamos con cada proyecto,
              adaptándonos a las necesidades y tendencias del momento, pero
              siempre manteniendo la coherencia con nuestra visión y valores.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- White Divider -->
<div class="w-full bg-black">
  <div class="w-[85%] h-px bg-white mx-auto"></div>
</div>

<!-- Contactanos Section -->
<div id="contacto" class="scroll-mt-28">
  <contactanos-section
    logoSrc="/assets/svgs/SPGA.svg"
    videoSrc="/assets/videos/Design your post.mp4"
    fallbackImageSrc="/assets/pictures/first-image.png"
    whatsappNumber="+58000-00000"
    email="spgagroup@gmail.com"
    designCredit="Maya Bottino"
    devCredit="Vicente Perez"
  ></contactanos-section>
</div>
